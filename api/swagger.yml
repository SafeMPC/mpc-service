# // Code generated by "make swagger"; DO NOT EDIT.
consumes:
- application/json
produces:
- application/json
swagger: "2.0"
info:
  description: API documentation
  title: github.com/SafeMPC/mpc-service
  version: 0.1.0
paths:
  /-/healthy:
    get:
      security:
      - Management: []
      description: |-
        This endpoint returns 200 when the service is healthy.
        Returns an human readable string about the current service status.
        In addition to readiness probes, it performs actual write probes.
        Note that /-/healthy is private (shielded by the mgmt-secret) as it may expose sensitive information about your service.
      produces:
      - text/plain
      tags:
      - common
      summary: Get healthy (liveness probe)
      operationId: GetHealthyRoute
      responses:
        "200":
          description: Ready.
        "521":
          description: Not ready.
  /-/ready:
    get:
      description: |-
        This endpoint returns 200 when the service is ready to serve traffic.
        Does read-only probes apart from the general server ready state.
        Note that /-/ready is typically public (and not shielded by a mgmt-secret), we thus prevent information leakage here and only return `"Ready."`.
      produces:
      - text/plain
      tags:
      - common
      summary: Get ready (readiness probe)
      operationId: GetReadyRoute
      responses:
        "200":
          description: Ready.
        "521":
          description: Not ready.
  /-/version:
    get:
      security:
      - Management: []
      description: This endpoint returns the module name, commit and build-date baked
        into the app binary.
      produces:
      - text/plain
      tags:
      - common
      summary: Get version
      operationId: GetVersionRoute
      responses:
        "200":
          description: ModuleName @ Commit (BuildDate)
  /.well-known/apple-app-site-association:
    get:
      description: Returns the Apple App Site Association file.
      tags:
      - well-known
      summary: Apple App Site Association
      operationId: GetAppleAppSiteAssociationRoute
      responses:
        "200":
          description: Apple App Site Association
  /.well-known/assetlinks.json:
    get:
      description: Returns the Android Digital Asset Links file.
      tags:
      - well-known
      summary: Android Digital Asset Links
      operationId: GetAndroidDigitalAssetLinksRoute
      responses:
        "200":
          description: Android Digital Asset Links
  /api/v1/auth/account:
    delete:
      security:
      - Bearer: []
      description: Completely delete the user account. This action is irreversible
        and therefore requires additional password authentication.
      tags:
      - auth
      summary: Delete user account
      operationId: DeleteUserAccountRoute
      parameters:
      - name: Payload
        in: body
        schema:
          $ref: '#/definitions/deleteUserAccountPayload'
      responses:
        "204":
          description: NoContent
        "400":
          description: PublicHTTPValidationError, type `INVALID_PASSWORD`
          schema:
            $ref: '#/definitions/publicHttpValidationError'
        "401":
          description: PublicHTTPError
          schema:
            $ref: '#/definitions/publicHttpError'
        "403":
          description: PublicHTTPError, type `USER_DEACTIVATED`/`NOT_LOCAL_USER`
          schema:
            $ref: '#/definitions/publicHttpError'
  /api/v1/auth/change-password:
    post:
      security:
      - Bearer: []
      description: |-
        After successful password change, all current access and refresh tokens are
        invalidated and a new set of auth tokens is returned
      tags:
      - auth
      summary: Change local user's password
      operationId: PostChangePasswordRoute
      parameters:
      - name: Payload
        in: body
        schema:
          $ref: '#/definitions/postChangePasswordPayload'
      responses:
        "200":
          description: PostLoginResponse
          schema:
            $ref: '#/definitions/postLoginResponse'
        "400":
          description: PublicHTTPValidationError, type `INVALID_PASSWORD`
          schema:
            $ref: '#/definitions/publicHttpValidationError'
        "401":
          description: PublicHTTPError
          schema:
            $ref: '#/definitions/publicHttpError'
        "403":
          description: PublicHTTPError, type `USER_DEACTIVATED`/`NOT_LOCAL_USER`
          schema:
            $ref: '#/definitions/publicHttpError'
  /api/v1/auth/forgot-password:
    post:
      description: |-
        Initiates a password reset for a local user, sending an email with a password
        reset link to the provided email address if a user account exists. Will always
        succeed, even if no user was found in order to prevent user enumeration
      tags:
      - auth
      summary: Initiate password reset for local user
      operationId: PostForgotPasswordRoute
      parameters:
      - name: Payload
        in: body
        schema:
          $ref: '#/definitions/postForgotPasswordPayload'
      responses:
        "204":
          description: Success
        "400":
          description: PublicHTTPValidationError
          schema:
            $ref: '#/definitions/publicHttpValidationError'
  /api/v1/auth/forgot-password/complete:
    post:
      description: |-
        Completes a password reset for a local user, using the password reset token sent via email
        to confirm user access, setting the new password if successful. All current access and refresh
        tokens are invalidated and a new set of auth tokens is returned
      tags:
      - auth
      summary: Completes password reset for local user
      operationId: PostForgotPasswordCompleteRoute
      parameters:
      - name: Payload
        in: body
        schema:
          $ref: '#/definitions/postForgotPasswordCompletePayload'
      responses:
        "200":
          description: PostLoginResponse
          schema:
            $ref: '#/definitions/postLoginResponse'
        "400":
          description: PublicHTTPValidationError, type `INVALID_PASSWORD`
          schema:
            $ref: '#/definitions/publicHttpValidationError'
        "403":
          description: PublicHTTPError, type `USER_DEACTIVATED`/`NOT_LOCAL_USER`
          schema:
            $ref: '#/definitions/publicHttpError'
        "404":
          description: PublicHTTPError, type `TOKEN_NOT_FOUND`
          schema:
            $ref: '#/definitions/publicHttpError'
        "409":
          description: PublicHTTPError, type `TOKEN_EXPIRED`
          schema:
            $ref: '#/definitions/publicHttpError'
  /api/v1/auth/login:
    post:
      description: Returns an access and refresh token on successful authentication
      tags:
      - auth
      summary: Login with local user
      operationId: PostLoginRoute
      parameters:
      - name: Payload
        in: body
        schema:
          $ref: '#/definitions/postLoginPayload'
      responses:
        "200":
          description: PostLoginResponse
          schema:
            $ref: '#/definitions/postLoginResponse'
        "400":
          description: PublicHTTPValidationError
          schema:
            $ref: '#/definitions/publicHttpValidationError'
        "401":
          description: PublicHTTPError
          schema:
            $ref: '#/definitions/publicHttpError'
        "403":
          description: PublicHTTPError, type `USER_DEACTIVATED`
          schema:
            $ref: '#/definitions/publicHttpError'
  /api/v1/auth/logout:
    post:
      security:
      - Bearer: []
      description: |-
        Logs the local user out, destroying the provided access token.
        A refresh token can optionally be provided, destroying it as well if found.
      tags:
      - auth
      summary: Log out local user
      operationId: PostLogoutRoute
      parameters:
      - name: Payload
        in: body
        schema:
          $ref: '#/definitions/postLogoutPayload'
      responses:
        "204":
          description: Success
        "400":
          description: PublicHTTPValidationError
          schema:
            $ref: '#/definitions/publicHttpValidationError'
        "401":
          description: PublicHTTPError
          schema:
            $ref: '#/definitions/publicHttpError'
  /api/v1/auth/refresh:
    post:
      description: |-
        Returns a fresh set of access and refresh tokens if a valid refresh token was provided.
        The old refresh token used to authenticate the request will be invalidated.
      tags:
      - auth
      summary: Refresh tokens
      operationId: PostRefreshRoute
      parameters:
      - name: Payload
        in: body
        schema:
          $ref: '#/definitions/postRefreshPayload'
      responses:
        "200":
          description: PostLoginResponse
          schema:
            $ref: '#/definitions/postLoginResponse'
        "400":
          description: PublicHTTPValidationError
          schema:
            $ref: '#/definitions/publicHttpValidationError'
        "401":
          description: PublicHTTPError
          schema:
            $ref: '#/definitions/publicHttpError'
        "403":
          description: PublicHTTPError, type `USER_DEACTIVATED`
          schema:
            $ref: '#/definitions/publicHttpError'
  /api/v1/auth/register:
    get:
      produces:
      - text/html
      tags:
      - auth
      summary: Page to complete registration
      operationId: GetCompleteRegisterRoute
      parameters:
      - type: string
        format: uuid4
        description: Registration token to complete the registration process
        name: token
        in: query
        required: true
      responses:
        "200":
          description: Page to complete registration
    post:
      description: |
        Registers a local user. If the registration process requires a confirmation
        the status code `202` is returned without auth tokens. Afterwards the registration needs to be confirmed
        using the `POST /api/v1/auth/register/{registrationToken}` endpoint.
      tags:
      - auth
      summary: Registers a local user
      operationId: PostRegisterRoute
      parameters:
      - name: Payload
        in: body
        schema:
          $ref: '#/definitions/postRegisterPayload'
      responses:
        "200":
          description: PostLoginResponse
          schema:
            $ref: '#/definitions/postLoginResponse'
        "202":
          description: RegisterResponse
          schema:
            $ref: '#/definitions/registerResponse'
        "400":
          description: PublicHTTPValidationError, type `INVALID_PASSWORD`
          schema:
            $ref: '#/definitions/publicHttpValidationError'
        "409":
          description: PublicHTTPError, type `USER_ALREADY_EXISTS`
          schema:
            $ref: '#/definitions/publicHttpError'
  /api/v1/auth/register/{registrationToken}:
    post:
      description: Completes registration for a local user
      tags:
      - auth
      summary: Complete registration
      operationId: PostCompleteRegisterRoute
      parameters:
      - type: string
        format: uuid4
        description: Registration token to complete the registration process
        name: registrationToken
        in: path
        required: true
      responses:
        "200":
          description: PostLoginResponse
          schema:
            $ref: '#/definitions/postLoginResponse'
        "401":
          description: Unauthorized
  /api/v1/auth/userinfo:
    get:
      security:
      - Bearer: []
      description: |-
        Returns user information compatible with the OpenID Connect Core 1.0 specification.
        Information returned depends on the requesting user as some data is only available if an app user profile exists.
      tags:
      - auth
      summary: Get user info
      operationId: GetUserInfoRoute
      responses:
        "200":
          description: GetUserInfoResponse
          schema:
            $ref: '#/definitions/getUserInfoResponse'
  /api/v1/push/token:
    put:
      security:
      - Bearer: []
      description: |-
        Adds a push token for the given provider to the current user.
        If the oldToken is present it will be deleted.
        Currently only the provider 'fcm' is supported.
      tags:
      - push
      summary: Adds a push token to the user
      operationId: PutUpdatePushTokenRoute
      parameters:
      - name: Payload
        in: body
        schema:
          $ref: '#/definitions/putUpdatePushTokenPayload'
      responses:
        "200":
          description: OK
        "404":
          description: PublicHTTPError, type `OLD_PUSH_TOKEN_NOT_FOUND`
          schema:
            $ref: '#/definitions/publicHttpError'
        "409":
          description: PublicHTTPError, type `PUSH_TOKEN_ALREADY_EXISTS`
          schema:
            $ref: '#/definitions/publicHttpError'
  /swagger.yml:
    get:
      description: |-
        OpenAPI Specification ver. 2 (fka Swagger)
        Returns our handcrafted and validated `swagger.yml`.
      produces:
      - text/plain
      tags:
      - common
      summary: Get swagger.yml
      operationId: GetSwaggerRoute
      responses:
        "200":
          description: OK
  /v1/auth/webauthn/login/begin:
    post:
      description: 生成 WebAuthn 登录选项和 challenge
      produces:
      - application/json
      tags:
      - WebAuthn
      summary: 开始 WebAuthn 登录
      operationId: postWebAuthnLoginBegin
      parameters:
      - name: body
        in: body
        required: true
        schema:
          $ref: '#/definitions/postWebAuthnLoginBeginPayload'
      responses:
        "200":
          description: 登录选项
          schema:
            $ref: '#/definitions/webAuthnLoginBeginResponse'
        "400":
          description: Bad Request
          schema:
            type: object
            properties:
              error:
                type: string
        "404":
          description: 用户不存在或无凭证
          schema:
            type: object
            properties:
              error:
                type: string
        "500":
          description: Internal Server Error
          schema:
            type: object
            properties:
              error:
                type: string
  /v1/auth/webauthn/login/finish:
    post:
      description: 验证前端返回的断言并生成访问令牌
      produces:
      - application/json
      tags:
      - WebAuthn
      summary: 完成 WebAuthn 登录
      operationId: postWebAuthnLoginFinish
      parameters:
      - name: body
        in: body
        required: true
        schema:
          $ref: '#/definitions/postWebAuthnLoginFinishPayload'
      responses:
        "200":
          description: 登录成功
          schema:
            $ref: '#/definitions/webAuthnLoginResponse'
        "400":
          description: Bad Request
          schema:
            type: object
            properties:
              error:
                type: string
        "401":
          description: 认证失败
          schema:
            type: object
            properties:
              error:
                type: string
        "500":
          description: Internal Server Error
          schema:
            type: object
            properties:
              error:
                type: string
  /v1/auth/webauthn/register/begin:
    post:
      description: 生成 WebAuthn 注册选项和 challenge
      produces:
      - application/json
      tags:
      - WebAuthn
      summary: 开始 WebAuthn 注册
      operationId: postWebAuthnRegisterBegin
      parameters:
      - name: body
        in: body
        required: true
        schema:
          $ref: '#/definitions/postWebAuthnRegisterBeginPayload'
      responses:
        "200":
          description: 注册选项
          schema:
            $ref: '#/definitions/webAuthnRegisterBeginResponse'
        "400":
          description: Bad Request
          schema:
            type: object
            properties:
              error:
                type: string
        "500":
          description: Internal Server Error
          schema:
            type: object
            properties:
              error:
                type: string
  /v1/auth/webauthn/register/finish:
    post:
      description: 验证前端返回的凭证并保存
      produces:
      - application/json
      tags:
      - WebAuthn
      summary: 完成 WebAuthn 注册
      operationId: postWebAuthnRegisterFinish
      parameters:
      - name: body
        in: body
        required: true
        schema:
          $ref: '#/definitions/postWebAuthnRegisterFinishPayload'
      responses:
        "200":
          description: 注册成功
          schema:
            type: object
            properties:
              message:
                type: string
                example: Passkey registered successfully
              success:
                type: boolean
                example: true
        "400":
          description: Bad Request
          schema:
            type: object
            properties:
              error:
                type: string
        "500":
          description: Internal Server Error
          schema:
            type: object
            properties:
              error:
                type: string
  /v1/sessions/{sessionId}:
    get:
      security:
      - Bearer: []
      description: 查询 DKG 或签名会话的当前状态
      tags:
      - Sessions
      summary: 获取会话状态
      operationId: getSession
      parameters:
      - type: string
        description: 会话 ID
        name: sessionId
        in: path
        required: true
      responses:
        "200":
          description: 会话信息
          schema:
            $ref: '#/definitions/sessionResponse'
        "401":
          description: 未授权
          schema:
            $ref: '#/definitions/publicHttpError'
        "404":
          description: 会话不存在
          schema:
            $ref: '#/definitions/publicHttpError'
        "500":
          description: 服务器错误
          schema:
            $ref: '#/definitions/publicHttpError'
  /v1/wallets:
    get:
      security:
      - Bearer: []
      description: 获取用户的所有钱包列表
      tags:
      - Wallets
      summary: 列出钱包
      operationId: getWallets
      parameters:
      - type: string
        example: ethereum
        description: 过滤区块链类型
        name: chain_type
        in: query
      - type: integer
        default: 20
        description: 每页数量
        name: limit
        in: query
      - type: integer
        default: 0
        description: 偏移量
        name: offset
        in: query
      responses:
        "200":
          description: 钱包列表
          schema:
            $ref: '#/definitions/listWalletsResponse'
        "401":
          description: 未授权
          schema:
            $ref: '#/definitions/publicHttpError'
        "500":
          description: 服务器错误
          schema:
            $ref: '#/definitions/publicHttpError'
    post:
      security:
      - Bearer: []
      description: 通过 DKG 创建 2-of-2 MPC 钱包，需要 WebAuthn 二次验证
      tags:
      - Wallets
      summary: 创建 MPC 钱包
      operationId: postCreateWallet
      parameters:
      - name: body
        in: body
        required: true
        schema:
          $ref: '#/definitions/postCreateWalletPayload'
      responses:
        "201":
          description: 钱包创建会话已创建
          schema:
            $ref: '#/definitions/createWalletResponse'
        "400":
          description: 请求参数错误
          schema:
            $ref: '#/definitions/publicHttpError'
        "401":
          description: 未授权或 WebAuthn 验证失败
          schema:
            $ref: '#/definitions/publicHttpError'
        "500":
          description: 服务器错误
          schema:
            $ref: '#/definitions/publicHttpError'
  /v1/wallets/{walletId}:
    get:
      security:
      - Bearer: []
      description: 获取指定钱包的详细信息
      tags:
      - Wallets
      summary: 获取钱包详情
      operationId: getWallet
      parameters:
      - type: string
        description: 钱包 ID
        name: walletId
        in: path
        required: true
      responses:
        "200":
          description: 钱包详情
          schema:
            $ref: '#/definitions/walletResponse'
        "401":
          description: 未授权
          schema:
            $ref: '#/definitions/publicHttpError'
        "404":
          description: 钱包不存在
          schema:
            $ref: '#/definitions/publicHttpError'
        "500":
          description: 服务器错误
          schema:
            $ref: '#/definitions/publicHttpError'
  /v1/wallets/{walletId}/addresses:
    post:
      security:
      - Bearer: []
      description: 为指定钱包生成新的区块链地址（HD 派生）
      tags:
      - Wallets
      summary: 生成钱包地址
      operationId: postGenerateWalletAddress
      parameters:
      - type: string
        name: walletId
        in: path
        required: true
      - name: body
        in: body
        required: true
        schema:
          $ref: '#/definitions/PostGenerateWalletAddressPayload'
      responses:
        "200":
          description: 地址生成成功
          schema:
            $ref: '#/definitions/generateAddressResponse'
        "400":
          description: 请求参数错误
          schema:
            $ref: '#/definitions/publicHttpError'
        "404":
          description: 钱包不存在
          schema:
            $ref: '#/definitions/publicHttpError'
        "500":
          description: 服务器错误
          schema:
            $ref: '#/definitions/publicHttpError'
  /v1/wallets/{walletId}/balance:
    get:
      security:
      - Bearer: []
      description: 查询指定钱包在区块链上的余额
      tags:
      - Wallets
      summary: 查询钱包余额
      operationId: getWalletBalance
      parameters:
      - type: string
        name: walletId
        in: path
        required: true
      - type: string
        example: ethereum
        description: 区块链类型
        name: chain_type
        in: query
        required: true
      responses:
        "200":
          description: 余额信息
          schema:
            $ref: '#/definitions/walletBalanceResponse'
        "401":
          description: 未授权
          schema:
            $ref: '#/definitions/publicHttpError'
        "404":
          description: 钱包不存在
          schema:
            $ref: '#/definitions/publicHttpError'
        "500":
          description: 服务器错误
          schema:
            $ref: '#/definitions/publicHttpError'
  /v1/wallets/{walletId}/sign:
    post:
      security:
      - Bearer: []
      description: 使用 MPC 钱包签名交易，需要 WebAuthn 二次验证
      tags:
      - Wallets
      summary: 签名交易
      operationId: postSignTransaction
      parameters:
      - type: string
        name: walletId
        in: path
        required: true
      - name: body
        in: body
        required: true
        schema:
          $ref: '#/definitions/postSignTransactionPayload'
      responses:
        "200":
          description: 签名会话已创建
          schema:
            $ref: '#/definitions/signTransactionResponse'
        "400":
          description: 请求参数错误
          schema:
            $ref: '#/definitions/publicHttpError'
        "401":
          description: 未授权或 WebAuthn 验证失败
          schema:
            $ref: '#/definitions/publicHttpError'
        "404":
          description: 钱包不存在
          schema:
            $ref: '#/definitions/publicHttpError'
        "500":
          description: 服务器错误
          schema:
            $ref: '#/definitions/publicHttpError'
  /v1/wallets/{walletId}/transactions:
    get:
      security:
      - Bearer: []
      description: 获取钱包的交易历史记录
      tags:
      - Wallets
      summary: 查询交易历史
      operationId: getWalletTransactions
      parameters:
      - type: string
        name: walletId
        in: path
        required: true
      - type: string
        example: ethereum
        description: 区块链类型
        name: chain_type
        in: query
        required: true
      - type: integer
        default: 20
        description: 每页数量
        name: limit
        in: query
      - type: integer
        default: 0
        description: 偏移量
        name: offset
        in: query
      responses:
        "200":
          description: 交易历史
          schema:
            $ref: '#/definitions/transactionsResponse'
        "401":
          description: 未授权
          schema:
            $ref: '#/definitions/publicHttpError'
        "404":
          description: 钱包不存在
          schema:
            $ref: '#/definitions/publicHttpError'
        "500":
          description: 服务器错误
          schema:
            $ref: '#/definitions/publicHttpError'
definitions:
  createWalletResponse:
    type: object
    required:
    - wallet_id
    - dkg_session_id
    - status
    - websocket_url
    properties:
      dkg_session_id:
        description: DKG 会话 ID
        type: string
        format: uuid
      status:
        description: 会话状态
        type: string
        enum:
        - pending
        - running
        - completed
        - failed
        example: pending
      wallet_id:
        description: 钱包 ID
        type: string
        format: uuid
      websocket_url:
        description: WebSocket 连接 URL（用于接收 DKG 协议消息）
        type: string
        example: ws://localhost:8080/v1/ws?token=xxx
  deleteUserAccountPayload:
    type: object
    required:
    - currentPassword
    properties:
      currentPassword:
        description: Current password of user
        type: string
        maxLength: 500
        minLength: 1
        example: correct horse battery staple
  generateAddressResponse:
    type: object
    required:
    - address
    - public_key
    properties:
      address:
        type: string
        example: "0x742d35Cc6634C0532925a3b844Bc9e7595f0bEb"
      derivation_path:
        type: string
        example: m/44'/60'/0'/0/0
      public_key:
        type: string
        example: 0x04...
  getSessionResponse:
    type: object
    required:
    - session_id
    - wallet_id
    - status
    properties:
      completed_at:
        type: string
        format: date-time
      created_at:
        type: string
        format: date-time
      duration_ms:
        description: 执行时长（毫秒）
        type: integer
      error_message:
        description: 错误信息（失败时）
        type: string
      progress:
        type: object
        properties:
          current_round:
            type: integer
            example: 1
          total_rounds:
            type: integer
            example: 6
      public_key:
        description: 公钥（DKG 完成后才有）
        type: string
        example: 0x...
      session_id:
        type: string
        format: uuid
      session_type:
        type: string
        enum:
        - dkg
        - signing
        example: signing
      signature:
        description: 签名结果（完成后才有）
        type: string
        example: 0x...
      status:
        type: string
        enum:
        - pending
        - running
        - completed
        - failed
        example: running
      wallet_id:
        type: string
        format: uuid
  getUserInfoResponse:
    type: object
    required:
    - sub
    - updated_at
    properties:
      email:
        description: Email address of user, if available
        type: string
        format: email
        maxLength: 255
        example: user@example.com
      scopes:
        description: Auth-Scopes of the user, if available
        type: array
        items:
          type: string
          enum:
          - app
          - cms
        example:
        - app
      sub:
        description: ID of user
        type: string
        example: 82ebdfad-c586-4407-a873-4cc1c33d56fc
      updated_at:
        description: Unix timestamp the user's info was last updated at
        type: integer
        example: 1591960808
  httpValidationErrorDetail:
    type: object
    required:
    - key
    - in
    - error
    properties:
      error:
        description: Error describing field validation failure
        type: string
      in:
        description: Indicates how the invalid field was provided
        type: string
      key:
        description: Key of field failing validation
        type: string
  listWalletsResponse:
    type: object
    required:
    - wallets
    - total
    - limit
    - offset
    properties:
      limit:
        description: 每页数量
        type: integer
      offset:
        description: 偏移量
        type: integer
      total:
        description: 总数
        type: integer
      wallets:
        type: array
        items:
          $ref: '#/definitions/walletSummary'
  orderDir:
    type: string
    enum:
    - asc
    - desc
  postChangePasswordPayload:
    type: object
    required:
    - currentPassword
    - newPassword
    properties:
      currentPassword:
        description: Current password of user
        type: string
        maxLength: 500
        minLength: 1
        example: correct horse battery staple
      newPassword:
        description: New password to set for user
        type: string
        maxLength: 500
        minLength: 1
        example: correct horse battery staple
  postCreateWalletPayload:
    type: object
    required:
    - algorithm
    - curve
    - chain_type
    properties:
      algorithm:
        description: 签名算法
        type: string
        enum:
        - ECDSA
        - EdDSA
        example: ECDSA
      chain_type:
        description: 区块链类型
        type: string
        enum:
        - ethereum
        - bitcoin
        - solana
        - polkadot
        example: ethereum
      curve:
        description: 椭圆曲线
        type: string
        enum:
        - secp256k1
        - ed25519
        example: secp256k1
      webauthn_assertion:
        $ref: '#/definitions/webAuthnAssertion'
  postForgotPasswordCompletePayload:
    type: object
    required:
    - token
    - password
    properties:
      password:
        description: New password to set for user
        type: string
        maxLength: 500
        minLength: 1
        example: correct horse battery staple
      token:
        description: Password reset token sent via email
        type: string
        format: uuid4
        example: ec16f032-3c44-4148-bbcc-45557466fa74
  postForgotPasswordPayload:
    type: object
    required:
    - username
    properties:
      username:
        description: Username to initiate password reset for
        type: string
        format: email
        maxLength: 255
        minLength: 1
        example: user@example.com
  postGenerateWalletAddressBody:
    type: object
    required:
    - chain_type
    properties:
      chain_type:
        description: 区块链类型
        type: string
        enum:
        - ethereum
        - bitcoin
        - solana
        - polkadot
        example: ethereum
      derivation_path:
        description: BIP44 派生路径（可选）
        type: string
        example: m/44'/60'/0'/0/0
  postGenerateWalletAddressPayload:
    type: object
    required:
    - chain_type
    properties:
      chain_type:
        description: 区块链类型
        type: string
        enum:
        - ethereum
        - bitcoin
        - solana
        - polkadot
        example: ethereum
      derivation_path:
        description: BIP44 派生路径（可选）
        type: string
        example: m/44'/60'/0'/0/0
  postLoginPayload:
    type: object
    required:
    - username
    - password
    properties:
      password:
        description: Password of user to authenticate as
        type: string
        maxLength: 500
        minLength: 1
        example: correct horse battery staple
      username:
        description: Username of user to authenticate as
        type: string
        format: email
        maxLength: 255
        minLength: 1
        example: user@example.com
  postLoginResponse:
    type: object
    required:
    - access_token
    - token_type
    - expires_in
    - refresh_token
    properties:
      access_token:
        description: Access token required for accessing protected API endpoints
        type: string
        format: uuid4
        example: c1247d8d-0d65-41c4-bc86-ec041d2ac437
      expires_in:
        description: Access token expiry in seconds
        type: integer
        format: int64
        example: 86400
      refresh_token:
        description: Refresh token for refreshing the access token once it expires
        type: string
        format: uuid4
        example: 1dadb3bd-50d8-485d-83a3-6111392568f0
      token_type:
        description: Type of access token, will always be `bearer`
        type: string
        example: bearer
  postLogoutPayload:
    type: object
    properties:
      refresh_token:
        description: Optional refresh token to delete while logging out
        type: string
        format: uuid4
        example: 700ebed3-40f7-4211-bc83-a89b22b9875e
  postRefreshPayload:
    type: object
    required:
    - refresh_token
    properties:
      refresh_token:
        description: Refresh token to use for retrieving new token set
        type: string
        format: uuid4
        example: 7503cd8a-c921-4368-a32d-6c1d01d86da9
  postRegisterPayload:
    type: object
    required:
    - username
    - password
    properties:
      password:
        description: Password to register with
        type: string
        maxLength: 500
        minLength: 1
        example: correct horse battery staple
      username:
        description: Username to register with
        type: string
        format: email
        maxLength: 255
        minLength: 1
        example: user@example.com
  postSignTransactionPayload:
    type: object
    required:
    - message_hex
    - chain_type
    properties:
      chain_type:
        type: string
        enum:
        - ethereum
        - bitcoin
        - solana
        example: ethereum
      derivation_path:
        description: 派生路径（可选）
        type: string
        example: m/44'/60'/0'/0/0
      message_hex:
        description: 待签名的消息（hex）
        type: string
        example: 0xf86c...
      webauthn_assertion:
        $ref: '#/definitions/webAuthnAssertion'
  postWebAuthnLoginBeginPayload:
    type: object
    required:
    - user_id
    properties:
      user_id:
        type: string
        example: user-123
  postWebAuthnLoginFinishPayload:
    type: object
    required:
    - user_id
    - session_data
    - response
    properties:
      response:
        description: 前端 navigator.credentials.get() 的返回结果
        type: object
      session_data:
        description: 从 begin 接口返回的 session_data
        type: string
      user_id:
        type: string
        example: user-123
  postWebAuthnRegisterBeginPayload:
    type: object
    required:
    - user_id
    - user_name
    properties:
      display_name:
        description: 显示名称
        type: string
        example: John Doe
      user_id:
        description: 用户唯一标识
        type: string
        example: user-123
      user_name:
        description: 用户名（通常是邮箱）
        type: string
        example: john@example.com
  postWebAuthnRegisterFinishPayload:
    type: object
    required:
    - user_id
    - user_name
    - session_data
    - response
    properties:
      response:
        description: 前端 navigator.credentials.create() 的返回结果
        type: object
      session_data:
        description: 从 begin 接口返回的 session_data
        type: string
      user_id:
        type: string
        example: user-123
      user_name:
        type: string
        example: john@example.com
  publicHttpError:
    type: object
    required:
    - status
    - type
    - title
    properties:
      detail:
        description: More detailed, human-readable, optional explanation of the error
        type: string
        example: User is lacking permission to access this resource
      status:
        description: HTTP status code returned for the error
        type: integer
        format: int64
        maximum: 599
        minimum: 100
        x-go-name: Code
        example: 403
      title:
        description: Short, human-readable description of the error
        type: string
        example: Forbidden
      type:
        $ref: '#/definitions/publicHttpErrorType'
  publicHttpErrorType:
    description: Type of error returned, should be used for client-side error handling
    type: string
    enum:
    - generic
    - PUSH_TOKEN_ALREADY_EXISTS
    - OLD_PUSH_TOKEN_NOT_FOUND
    - ZERO_FILE_SIZE
    - USER_DEACTIVATED
    - INVALID_PASSWORD
    - NOT_LOCAL_USER
    - TOKEN_NOT_FOUND
    - TOKEN_EXPIRED
    - USER_ALREADY_EXISTS
    - MALFORMED_TOKEN
    - LAST_AUTHENTICATED_AT_EXCEEDED
    - MISSING_SCOPES
    - validation
  publicHttpValidationError:
    type: object
    required:
    - validationErrors
    allOf:
    - $ref: '#/definitions/publicHttpError'
    properties:
      validationErrors:
        description: List of errors received while validating payload against schema
        type: array
        items:
          $ref: '#/definitions/httpValidationErrorDetail'
  putUpdatePushTokenPayload:
    type: object
    required:
    - newToken
    - provider
    properties:
      newToken:
        description: New push token for given provider.
        type: string
        maxLength: 500
        example: 1c91e550-8167-439c-8021-dee7de2f7e96
      oldToken:
        description: Old token that can be deleted if present.
        type: string
        maxLength: 500
        x-nullable: true
        example: 495179de-b771-48f0-aab2-8d23701b0f02
      provider:
        description: Identifier of the provider the token is for (eg. "fcm", "apn").
          Currently only "fcm" is supported.
        type: string
        maxLength: 500
        example: fcm
  registerResponse:
    type: object
    required:
    - requiresConfirmation
    properties:
      requiresConfirmation:
        description: Indicates whether the registration process requires email confirmation
        type: boolean
        example: true
  sessionResponse:
    $ref: '#/definitions/getSessionResponse'
  signTransactionResponse:
    type: object
    required:
    - session_id
    - status
    - websocket_url
    properties:
      estimated_time:
        description: 预计完成时间
        type: string
        example: 2s
      session_id:
        description: 签名会话 ID
        type: string
        format: uuid
      status:
        type: string
        enum:
        - pending
        - signing
        - completed
        - failed
        example: pending
      websocket_url:
        description: WebSocket 连接 URL（用于协议消息交换）
        type: string
        example: ws://localhost:8080/v1/ws?token=xxx
  transaction:
    type: object
    properties:
      block_number:
        type: integer
      from:
        type: string
        example: 0x...
      status:
        type: string
        enum:
        - pending
        - confirmed
        - failed
        example: confirmed
      timestamp:
        type: string
        format: date-time
      to:
        type: string
        example: 0x...
      tx_hash:
        type: string
        example: 0x...
      value:
        type: string
        example: "1.5"
  transactionsResponse:
    type: object
    required:
    - transactions
    - total
    properties:
      limit:
        type: integer
      offset:
        type: integer
      total:
        type: integer
      transactions:
        type: array
        items:
          $ref: '#/definitions/transaction'
  walletBalanceResponse:
    type: object
    required:
    - balance
    - symbol
    - decimals
    properties:
      balance:
        description: 余额（字符串，避免精度损失）
        type: string
        example: "1.5"
      chain_type:
        type: string
        example: ethereum
      decimals:
        type: integer
        example: 18
      symbol:
        type: string
        example: ETH
  walletResponse:
    type: object
    required:
    - wallet_id
    - address
    - public_key
    - chain_type
    properties:
      address:
        type: string
        example: "0x742d35Cc6634C0532925a3b844Bc9e7595f0bEb"
      algorithm:
        type: string
        example: ECDSA
      chain_type:
        type: string
        example: ethereum
      created_at:
        type: string
        format: date-time
      curve:
        type: string
        example: secp256k1
      public_key:
        description: 公钥（hex）
        type: string
        example: 0x04...
      threshold:
        type: integer
        example: 2
      total_nodes:
        type: integer
        example: 2
      wallet_id:
        type: string
        format: uuid
  walletSummary:
    type: object
    properties:
      address:
        type: string
        example: "0x742d35Cc6634C0532925a3b844Bc9e7595f0bEb"
      algorithm:
        type: string
        example: ECDSA
      chain_type:
        type: string
        example: ethereum
      created_at:
        type: string
        format: date-time
      curve:
        type: string
        example: secp256k1
      public_key:
        type: string
        example: 0x04...
      wallet_id:
        type: string
        format: uuid
  webAuthnAssertion:
    type: object
    required:
    - credential_id
    - authenticator_data
    - client_data_json
    - signature
    properties:
      authenticator_data:
        description: Authenticator Data (base64)
        type: string
        format: byte
      client_data_json:
        description: Client Data JSON (base64)
        type: string
        format: byte
      credential_id:
        description: WebAuthn Credential ID (base64)
        type: string
        format: byte
        example: Y3JlZGVudGlhbC1pZA==
      signature:
        description: Signature (base64)
        type: string
        format: byte
  webAuthnLoginBeginResponse:
    type: object
    required:
    - options
    - session_data
    properties:
      options:
        description: WebAuthn CredentialRequestOptions
        type: object
      session_data:
        description: 会话数据（Base64URL 编码的 challenge）
        type: string
  webAuthnLoginResponse:
    type: object
    required:
    - success
    - access_token
    properties:
      access_token:
        description: 访问令牌（JWT）
        type: string
      expires_in:
        description: 令牌过期时间（秒）
        type: integer
        example: 3600
      success:
        type: boolean
        example: true
  webAuthnRegisterBeginResponse:
    type: object
    required:
    - options
    - session_data
    properties:
      options:
        description: WebAuthn CredentialCreationOptions
        type: object
      session_data:
        description: 会话数据（Base64URL 编码的 challenge）
        type: string
parameters:
  registrationTokenParam:
    type: string
    format: uuid4
    description: Registration token to complete the registration process
    name: registrationToken
    in: path
    required: true
responses:
  AuthForbiddenResponse:
    description: PublicHTTPError, type `USER_DEACTIVATED`/`NOT_LOCAL_USER`
    schema:
      $ref: '#/definitions/publicHttpError'
  AuthUnauthorizedResponse:
    description: PublicHTTPError
    schema:
      $ref: '#/definitions/publicHttpError'
  InvalidPasswordResponse:
    description: PublicHTTPValidationError, type `INVALID_PASSWORD`
    schema:
      $ref: '#/definitions/publicHttpValidationError'
  ValidationError:
    description: PublicHTTPValidationError
    schema:
      $ref: '#/definitions/publicHttpValidationError'
  errorResponse:
    description: Standard error response
    schema:
      $ref: '#/definitions/publicHttpError'
securityDefinitions:
  Bearer:
    description: |-
      Access token for application access, **must** include "Bearer " prefix.
      Example: `Bearer b4a94a42-3ea2-4af3-9699-8bcbfee6e6d2`
    type: apiKey
    name: Authorization
    in: header
    x-keyPrefix: 'Bearer '
  Management:
    description: Management secret, used for monitoring and infrastructure related
      calls
    type: apiKey
    name: mgmt-secret
    in: query
